         ╔═════════════════════════════════╗
         ║                                                         ║
         ║  COMMUNICATIONS PROGRAM FOR CASIO FX-850P/FX-880P       ║
         ║                                                         ║
         ╚═════════════════════════════════╝


                              Version 1.4
                           November 27, 1996
                        (C) FELIPE POLO LEONOR


1. DESCRIPTION

     This program allows the manipulation and transfer of files
between a PC and a Casio FX-850P/FX-880P calculator (possibly also
works with the PB-1000 model).

     Its most outstanding feature is that the connection between both teams
It is done through the parallel port of the PC (LPT1), only through ONE
CONNECTOR AND FOUR WIRES, without the need for any other additional circuitry
(for example, the FA-6 unit).

     The program is built in a Turbo Vision environment, and makes use of the
calculator character set, which allows writing, reading,
correction and printing of programs (and database), WYSIWYG style.
It requires the presence of a VGA graphics card, and a 286 or higher processor.

     The sale of this program is prohibited. The author is not responsible for
any damage that may be caused to the equipment, programs or data of the
user, either accidentally or due to the use, due or improper, of the program
or the cable described in this document.


2. CONNECTION

     If we adopt as the numbering of the inputs of the Casio connector the
Next:

                             1┌┬┬┬┬┬┬┬┬┬┬┬┬┬┬┐15
                              ├┼┼┼┼┼┼┼┼┼┼┼┼┼┼┤
                            16└┴┴┴┴┴┴┴┴┴┴┴┴┴┴┘30

and we use 36-pin Amphenol connector or 25-pin D-type connector on
the PC, the correspondence is:

                            Casio PC
                              5 ----- 2 (DATA0)
                             21 ----- 10 (/ACK)
                             22 ----- 11 (BUSY)
                             30 ----- 19 (GND)

     If the printer connection uses a different one, look for the pins
of the signals given in the documentation of the connector.

     The ideal is to buy a connector identical to the one mounted on the
printer, so that it can be assembled to the end of the cable coming from the PC.
This way we will have more mobility than if we connect directly to the output of
printer that comes with the PC.

     The most suitable type of cable for connecting the calculator is the
used in telephony, for example for the installation of extension phones,
because it is monofilament and has the appropriate diameter for its introduction
into the Casio plug.


3. HANDLING

     The program is almost self-explanatory. For a correct transfer,
you only have to respect the order in which the operations are executed, 
according to indicate the messages that appear when using the Transmission 
options and Reception.

     To enter special characters, press the ALT key, and without
release it, write IN THE NUMERIC KEYBOARD the code corresponding to the
desired character (in decimal), and release the ALT key. To find out the
codes, it is convenient to use the Character Table of the menu of the
left. The special characters will only be displayed if when starting the
program, the "Use Casio-type characters" option is enabled.

     In the tests I have done, the calculator has been able to follow the
transfer rate at 4800 bps, both in Transmission and Reception.
However, if there are problems at this speed, it is recommended to try a
minor.

     To receive a BASIC program on the PC, put the calculator in mode
BASIC (MODE 1), go to the program area ("S" + area), and write
SAVE "COM0:speed", where speed is the one indicated by pressing F8
(Reception) on the PC. Then press FIRST Enter (or OK) on the PC and
SECOND execute the SAVE in the calculator. In case you want
receive the contents of the Data Bank, write to the Casio
SAVE#"COM0:speed".

     To transmit a program to the calculator, a procedure is followed
similar, but using LOAD instead of SAVE, and giving the commands
confirmation of the transfer FIRST to the Casio, and SECOND to the PC. Idem
Regarding the Database.

     The default extension of all files is .FX


4. DOCUMENT PRINTING

     To make it easy to get hard copies of .FX files, using
the character set of the calculator, the file CASIO.FON is attached, which
contains the "Casio FX-850P" typeface in Windows font format.

     The installation of the font is done through the Control Panel of
Windows, using the Fonts | Add, and selecting the font
"CasioFX850". From then on, the .FX files generated by the
communications program can be printed correctly fromfrom any
word processor that allows the selection of fonts, such as Write or
Word. You can also use the Character Map from the Accessories group to
visualize the entire character set more clearly.

     Of course, if the text to be printed does not contain characters
extended, or you prefer to use another type of letter, you can make the
printing from any ASCII text editor, without the need to enter
even on Windows.


5. INCOMPATIBILITIES

     During transfers, the program takes exclusive ownership of the
interrupt 8, for parallel port sampling requirements. This paralyzes
the BIOS clock (but not the CMOS) in the instants that the transfer lasts, and
it is Some strange behavior with the floppy drive motor is possible, if the 
drives were running at the start of a transfer (e.g., if running
the program from floppy). There may be a conflict if some other program does
use of interrupt 8 (resident or inside a shell).

     Within DOS sessions under Windows, the program works correctly
as an editor, but I do not guarantee that the Transmission and
Reception (in fact, they don't work for me). The extended character set
will only be visible if run in full screen mode, rather than in
window.

     The settings (speeds, port and initial video mode) are stored
by modifying the executable itself, so that it is necessary to avoid the
adherence of checksums by antivirus utilities. The program is
self-checks on startup, and you're unlikely to get an infection
virus without its functioning being interrupted.


6. VERSIONS

     Version 1.4:

     - Files can now be opened from the command line: e.g. to
       that the editor opens all files with an FX extension, it can be written
       "CASIO *.FX". If the file entered as parameter did not exist in the
       disk, a new document with that name will open. If not specified
       no parameters, a blank document will be opened by default.
     - Creation of the CASIO.FON font file, which allows the
       printing programs under Windows, using the character set
       original calculator.
     - Correction of the errors produced when using the keyboard during the
       data transfers.
     - Inclusion of a new box in Options|Settings, which allows
       select the printer port to use for transfers.
     - Access to menus with the ALT key is incorporated, in addition to F10.
     - Changes of name and position of some menu options.
     - Inclusion of a box that appears during the wait in the reception of
       data, indicating the situation.
     - Updating the email address listed on this
       document, and general revision of the text.
     - Change of the compression method of the executable.

     Version 1.3: Fixed a bug that prevented reception on some
systems (mainly 486's): Extracted values ​​are now masked
of the port, to filter only bits 6 and 7. The remaining bits
(0 to 5) may change depending on the input/output card.

     Version 1.2: Displays an error message when trying to Stream
from an empty window. Removes the disappearing effect of the cursor when
return to the operating system. Fixes an error that occurred after opening
many windows in one session. Disables mouse events during
data transfers.

     Version 1.1: Included an option that allows to disable the game of
Casio special characters. Correction of a telltale label that appeared when
make a shell to DOS.

     Version 1.0: First public version of the program.


7. USER SERVICE

     If you want more information, report an error, or simply keep
correspondence, you can leave a mail message on the Internet, sending it to the
address fpolo@teleco.upv.es (valid at least until September 1997).

     Lastly, I would like to thank the collaboration of all the users who
They have helped with their suggestions and bug detection. Without your help, the
program would still remain at version 1.0. If the cooperation continues,
I bet this won't be the last.